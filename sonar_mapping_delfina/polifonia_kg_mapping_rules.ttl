@prefix : <https://w3id.org/polifonia/ON/core> .
@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix xs: <http://www.w3.org/2001/XMLSchema#> .
@prefix cpv: <https://w3id.org/italia/onto/CPV/> .
@prefix mp: <https://w3id.org/polifonia/ON/musical-performance/> .
@prefix core: <https://w3id.org/polifonia/ON/core/> .

:RecordingTriplesMap 
    rml:logicalSource :RecordingSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/Recording/recording_{track_id}";
        rr:class mp:Recording
    ] ;

    rr:predicateObjectMap [
        rr:predicate mp:hasRecordingPerformer;
        rr:objectMap [
            rr:template "https://w3id.org/polifonia/resource/Agent/{artist}" 
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:hasTitle;
        rr:objectMap [
            rr:template "https://w3id.org/polifonia/resource/Title/{title}" 
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate mp:hasSession;
        rr:objectMap [
            rr:template "https://w3id.org/polifonia/resource/Session/session_{track_id}_{recording_places[*].type-id}" 
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate mp:hasYoutubeID;
        rr:objectMap [
            rr:template "http://youtube.com/{youtube_id}"
        ]
    ] .


:AgentTriplesMap 
    rml:logicalSource :AgentSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/Agent/{artist}";
        rr:class core:Agent
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label;
        rr:objectMap [
            rml:reference "artist";
            rr:datatype xs:string;
        ]
    ] .


:TitleTriplesMap 
    rml:logicalSource :TitleSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/Title/{title}";
        rr:class core:Title
    ] ;


    rr:predicateObjectMap [
        rr:predicate rdfs:label;
        rr:objectMap [
            rml:reference "title";
            rr:datatype xs:string;
        ]
    ] .


:SessionTriplesMap 
    rml:logicalSource :SessionSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/Session/{ref_id}_{type}";
        rr:class mp:Session
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:hasType;
        rr:objectMap [
            rr:template "https://w3id.org/polifonia/resource/SessionType/{type-id}" 
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:startTime;
        rr:objectMap [
            rml:reference "begin"
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:endTime;
        rr:objectMap [
            rml:reference "end"
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:hasPlace;
        rr:objectMap [
            rr:template "https://w3id.org/polifonia/resource/PhysicalPlace/physical_place_{place.id}" 
        ]
    ] .

:SessionTypeTriplesMap 
    rml:logicalSource :SessionTypeSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/SessionType/{type-id}";
        rr:class mp:SessionType
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label;
        rr:objectMap [
            rml:reference "type";
            rr:datatype xs:string;
        ]
    ] .


:PhysicalPlacesTriplesMap 
    rml:logicalSource :PhysicalPlaceSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/PhysicalPlace/physical_place_{id}";
        rr:class core:PhysicalPlace
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label;
        rr:objectMap [
            rml:reference "name";
            rr:datatype xs:string;
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:hasAddress;
        rr:objectMap [
            rml:reference "address";
            rr:datatype xs:string;
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:hasCoordinate;
        rr:objectMap [
            rr:template "https://w3id.org/polifonia/resource/Coordinate/coordinate_{id}" 
        ]
    ] .


:CoordinateTriplesMap 
    rml:logicalSource :CoordinateSource ;
    rr:subjectMap [
        rr:template "https://w3id.org/polifonia/resource/Coordinate/coordinate__{id}";
        rr:class core:Coordinate
    ] ;


    rr:predicateObjectMap [
        rr:predicate core:lat;
        rr:objectMap [
            rml:reference "coordinates.latitude";
            rr:datatype xs:decimal;
        ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate core:long;
        rr:objectMap [
            rml:reference "coordinates.longitude";
            rr:datatype xs:decimal;
        ]
    ] .




:RecordingSource rml:source "./sources/places_input.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*]" .

:AgentSource rml:source "./sources/places_input2.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*]" .

:TitleSource rml:source "./sources/places_input3.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*]" .

:SessionSource rml:source "./sources/places_input4.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*].recording_places[*]" .

:SessionTypeSource rml:source "./sources/places_input5.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*].recording_places[*]" .

:PhysicalPlaceSource rml:source "./sources/places_input6.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*].recording_places[*].place" .

:CoordinateSource rml:source "./sources/places_input7.json";
    rml:referenceFormulation ql:JSONPath ;
    rml:iterator "$.tracks[*].recording_places[*].place" .
